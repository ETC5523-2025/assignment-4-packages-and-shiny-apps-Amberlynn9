---
title: "Analysis of Healthcare-Associated Infections in Germany"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Analysis of Healthcare-Associated Infections in Germany}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Introduction

This vignette summarises the analysis from *Zacher et al. (2019)*, comparing the burden of healthcare-associated infections (HAIs) in Germany with the EU/EEA average.\
The results show that Germany experiences a **higher population-level burden** despite lower hospital prevalence rates, due mainly to longer inpatient stays and higher admission numbers.

# Dataset

The dataset `hai_burden` is adapted from *Table 2* of Zacher et al. (2019), summarising the estimated burden of HAIs per 100,000 population across infection types and sample groups.

It includes three main measures:

-    **HAIs per 100k** : infection rate

-    **Deaths per 100k** : attributable mortality

-    **DALYs per 100k** : Disability-Adjusted Life Years (total health loss)

Each measure is reported for infection types (*HAP*, *UTI*, *BSI*, *SSI*, *CDI*, *All*) and three sample groups (*German_PPS*, *German_convenience*, *EU_EEA*).

```{r}
library(etc5523nhu)
data("hai_burden")
knitr::kable(head(hai_burden), caption = "HAI burden dataset included in the package.")

```

# Visual Summary

The plot below compares **DALYs per 100,000** across infection types and sample groups.\

It shows both the estimated burden and the uncertainty intervals, highlighting how Germany’s burden compares with the EU/EEA average.

```{r, message=FALSE, warning=FALSE, fig.height=6, fig.width=8}
#| label: fig-1
#| fig-cap: "Estimated HAI burden per 100,000 population, Germany vs EU/EEA (2011–2012)"
#| message: false
#| warning: false
#| code-fold: true
library(etc5523nhu)
library(ggplot2)
library(dplyr)

# Load dataset safely
data("hai_burden")


# Filter for DALYs per 100k (only runs if column exists)
if ("measure" %in% names(hai_burden)) {
  dalys_data <- dplyr::filter(hai_burden, measure == "DALYs per 100k")

  ggplot(dalys_data, aes(x = infection, y = estimate, color = sample)) +
    geom_point(size = 3, position = position_dodge(width = 0.6)) +
    geom_errorbar(aes(ymin = ci_low, ymax = ci_high),
                  width = 0.3, position = position_dodge(width = 0.6)) +
    labs(
      title = "DALYs per 100,000 Population by Infection Type",
      subtitle = "Comparing German samples and EU/EEA averages (Zacher et al., 2019)",
      x = "Infection Type",
      y = "Estimated DALYs per 100,000",
      color = "Sample Group"
    ) +
    scale_color_manual(values = c("#1B9E77", "#D95F02", "#7570B3")) +
    theme_minimal(base_size = 14) +
    theme(
      plot.title = element_text(face = "bold", hjust = 0.5),
      plot.subtitle = element_text(hjust = 0.5, color = "gray40"),
      legend.position = "bottom",
      axis.text.x = element_text(angle = 25, hjust = 1)
    )
} else {
  message("⚠️ Column 'measure' not found in hai_burden dataset.")
}
```



# The Shiny App

You can launch the interactive dashboard using:

```{r, eval=FALSE}
run_app()
```

The app allows users to:

-    Select a **measure** (HAIs, deaths, or DALYs)

-    Choose an **infection type**

-    Compare results between **German** and **EU/EEA** samples

-    **Download** the filtered data for further use

It combines data filtering and dynamic visualisation, helping users explore how infection burden varies across regions and types.

# Conclusion

The **etc5523nhu** package brings the findings of *Zacher et al. (2019)* to life through both reproducible data and interactive analysis.\
The dataset provides detailed infection metrics, while the Shiny app allows hands-on exploration, making it easier to understand how healthcare-associated infections impact Germany and Europe.

Together, they demonstrate how R packages can make epidemiological data both transparent and engaging for users.

# Reference

Zacher B., Haller S., Willrich N., Walter J., Abu Sin M., Cassini A., Plachouras D., Suetens C., & Eckmanns T. (2019). Application of a new methodology and R package reveals a high burden of healthcare-associated infections in Germany compared to the average in the EU/EEA, 2011–2012. EuroSurveillance, 24(46), 1900135. <https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2019.24.46.1900135>
